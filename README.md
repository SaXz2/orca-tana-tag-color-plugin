# Orca Tana 标签颜色插件

为 Orca Note 中带标签的块应用 Tana 风格的颜色和图标样式。

## ✨ 功能特性

- 🎨 **标签颜色继承**：自动为带标签的块应用标签定义的颜色
- 🎯 **块级颜色覆盖**：支持在块级别单独设置颜色，优先级高于标签颜色
- 🔖 **图标支持**：显示标签定义的自定义图标
- 🎪 **折叠状态样式**：为折叠的块应用半透明背景色
- 🔄 **实时更新**：自动监听面板变化和设置变化，实时应用样式
- 🎛️ **灵活配置**：提供多种配置选项以适应不同需求

## 📦 安装

1. 下载本插件
2. 在 Orca Note 中进入插件管理
3. 加载插件文件夹

## 🚀 使用方法

### 基本使用

1. 在 Orca Note 中创建一个标签块（别名块）
2. 为标签块添加 `_color` 属性并设置颜色值（如 `#ff5733`）
3. （可选）为标签块添加 `_icon` 属性并设置图标值
4. 在任意块中添加该标签，插件会自动应用颜色和图标样式

### 块级颜色覆盖

如果需要为特定的块设置不同的颜色：

1. 在带标签的块上添加 `_color` 属性
2. 设置颜色值并启用该属性（type 设为 1）
3. 该块将使用自己的颜色而不是标签的颜色
4. 图标仍然从标签读取

### 颜色属性格式

- `_color` 属性值应为十六进制颜色代码，例如：`#ff5733`、`#3498db`
- `_icon` 属性值为图标名称（Tabler Icons）

## ⚙️ 配置选项

### 使用 DOM 颜色

- **设置项**：`useDomColor`
- **类型**：布尔值
- **默认值**：`false`
- **说明**：
  - 启用后，标签颜色将使用 DOM 中渲染的实际颜色（受主题影响）
  - 禁用时，使用 `_color` 属性中定义的原始颜色值
  - 注意：块级颜色覆盖时，始终使用 `_color` 属性值，不受此设置影响

### 调试模式

- **设置项**：`debugMode`
- **类型**：布尔值
- **默认值**：`false`
- **说明**：启用后在浏览器控制台输出详细的调试信息

## 🎯 工作原理

1. **监听面板变化**：插件监听 Orca 状态变化，检测面板的打开、关闭和切换
2. **识别带标签的块**：扫描所有面板中的容器块，找出带有标签的块
3. **读取颜色属性**：
   - 优先检查块自身的 `_color` 属性
   - 如果块没有颜色，则使用第一个标签的 `_color` 属性
4. **读取图标属性**：从标签的 `_icon` 属性读取图标
5. **应用样式**：
   - 为块的无序点（bullet point）设置颜色
   - 如果块处于折叠状态，添加半透明背景色
   - 显示自定义图标（如果有）
6. **持续监听**：监听块的折叠/展开状态变化，动态更新样式

## 🔧 技术细节

- **防抖处理**：使用 300ms 防抖避免频繁更新
- **优先级规则**：块级颜色 > 标签颜色
- **图标来源**：始终从标签读取
- **折叠背景色**：使用 colorValue + 0.45 透明度

## 📝 命令

### `getAllPanelBlockIds`

手动触发获取所有面板的块 ID 并应用样式。通常不需要手动调用，插件会自动处理。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

MIT License
